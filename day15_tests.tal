~library/macros.tal
~library/devices.tal

( variables )

|0000

|0100 @program

  T< "matrix: >T
  S<
    "1163751742 0a
    "1381373672 0a
    "2136511328 0a
    "3694931569 0a
    "7463417111 0a
    "1319128137 0a
    "1359912421 0a
    "3125421639 0a
    "1293138521 0a
    "2311944581 0a
  >S ;make-get-byte JSR2 ;risk-matrix/parse JSR2
  ;risk-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0001 0001 0006 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 0001 0003 0008 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 0002 0001 0003 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 0003 0006 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  T< "cost-init: >T
  ;cost-matrix/init JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  T< "set-start: >T
  #0010 #0000 #0000 ;cost-matrix/set-at JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  T< "combine-at: >T
  #0010 #0000 #0001 ;cost-matrix/combine-at JSR2
  #0010 #0001 #0000 ;cost-matrix/combine-at JSR2
  #0010 #0000 #ffff ;cost-matrix/combine-at JSR2
  #0010 #ffff #0000 ;cost-matrix/combine-at JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0011 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0011 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ;cost-matrix/list-dump JSR2
  ( EXPECT 0 0 0010 )
  ( EXPECT 0 1 0011 )
  ( EXPECT 1 0 0011 )
  ;cost-matrix/count JSR2 DBGSHORTDEC POP2
  ( EXPECT 3 )
  T< "combine-at2: >T
  #0011 #0002 #0000 ;cost-matrix/combine-at JSR2
  #0011 #0000 #0000 ;cost-matrix/combine-at JSR2
  #0011 #0001 #ffff ;cost-matrix/combine-at JSR2
  #0011 #0001 #0001 ;cost-matrix/combine-at JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0011 0017 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0011 0014 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  T< "combine-at3: >T
  #0011 #0001 #0001 ;cost-matrix/combine-at JSR2
  #0011 #ffff #0001 ;cost-matrix/combine-at JSR2
  #0011 #0000 #0000 ;cost-matrix/combine-at JSR2
  #0011 #0000 #0002 ;cost-matrix/combine-at JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0011 0017 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0011 0014 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0013 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  T< "flood-from: >T
  #0000 #0002 ;cost-matrix/flood-from JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0011 0017 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0011 0014 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0013 0014 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0016 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  T< "flood-matching: >T
  #0013 ;cost-matrix/flood-matching JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0011 0017 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0011 0014 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0013 0014 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0016 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  T< "flood-matching2: >T
  #0014 ;cost-matrix/flood-matching JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0011 0017 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0011 0014 001c 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0013 0014 0017 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0016 001a 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  T< "flood-matching3: >T
  #0016 ;cost-matrix/flood-matching JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0011 0017 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0011 0014 001c 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0013 0014 0017 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0016 001a 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 001d 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  ( EXPECT 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  )
  T< "flood-all: >T
  ;cost-matrix/flood-all JSR2
  ;cost-matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0010 0011 0017 001a 0021 0026 0027 002e 0032 0034  )
  ( EXPECT 0011 0014 001c 001b 001e 0025 0027 002d 0030 0032  )
  ( EXPECT 0013 0014 0017 001d 0022 0023 0024 0027 0029 0031  )
  ( EXPECT 0016 001a 0020 0021 002a 0026 0025 002a 002f 0036  )
  ( EXPECT 001d 001e 0024 0024 0028 0027 002c 002b 002c 002d  )
  ( EXPECT 001e 0021 0022 002b 0029 0029 0031 002c 002f 0034  )
  ( EXPECT 001f 0022 0027 0030 0032 002a 002c 0030 0031 0032  )
  ( EXPECT 0022 0023 0025 002a 002e 002c 002d 0033 0034 003b  )
  ( EXPECT 0023 0025 002e 002d 002e 002f 0035 0038 0036 0037  )
  ( EXPECT 0025 0028 0029 002a 0033 0033 0037 003c 003e 0038  )
  T< "get-end-cost: >T
  ;cost-matrix/get-end-cost JSR2 DBGSHORTDEC POP2
  ( EXPECT 40 )


  T< "👍 >T
  BRK !

( s* -- get-byte )
@make-get-byte
  ;input STA2
  ;get-byte-from-input
  RTN

( -- b )
@get-byte-from-input
  [ ;input LDA2 ] LDA STH
  [ ;input LDA2 ] INC2 [ ;input STA2 ]
  STHr
  RTN

@input $2

~library/test.tal
~day15_lib.tal
