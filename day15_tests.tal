~library/macros.tal
~library/devices.tal

( variables )

|0000

|0100 @program

  T< "matrix: >T
  S<
    "1163751742 0a
    "1381373672 0a
    "2136511328 0a
    "3694931569 0a
    "7463417111 0a
    "1319128137 0a
    "1359912421 0a
    "3125421639 0a
    "1293138521 0a
    "2311944581 0a
  >S ;make-get-byte JSR2 ;matrix/parse JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 0001 0001 0006 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 0001 0003 0008 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 0002 0001 0003 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 0003 0006 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  #8000 #0000 #0000 ;matrix/set-at JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 0001 0006 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 0001 0003 0008 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 0002 0001 0003 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 0003 0006 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  #8000 #0000 #0001 ;matrix/combine-at JSR2
  #8000 #0001 #0000 ;matrix/combine-at JSR2
  #8000 #0000 #ffff ;matrix/combine-at JSR2
  #8000 #ffff #0000 ;matrix/combine-at JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 8001 0006 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 8001 0003 0008 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 0002 0001 0003 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 0003 0006 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  #8001 #0002 #0000 ;matrix/combine-at JSR2
  #8001 #0000 #0000 ;matrix/combine-at JSR2
  #8001 #0001 #ffff ;matrix/combine-at JSR2
  #8001 #0001 #0001 ;matrix/combine-at JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 8001 8007 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 8001 8004 0008 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 0002 0001 0003 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 0003 0006 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  #8001 #0001 #0001 ;matrix/combine-at JSR2
  #8001 #ffff #0001 ;matrix/combine-at JSR2
  #8001 #0000 #0000 ;matrix/combine-at JSR2
  #8001 #0000 #0002 ;matrix/combine-at JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 8001 8007 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 8001 8004 0008 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 8003 0001 0003 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 0003 0006 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  #0000 #0002 ;matrix/flood-from JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 8001 8007 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 8001 8004 0008 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 8003 8004 0003 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 8006 0006 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  #8003 ;matrix/flood-matching JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 8001 8007 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 8001 8004 0008 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 8003 8004 0003 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 8006 0006 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  #8004 ;matrix/flood-matching JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 8001 8007 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 8001 8004 800c 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 8003 8004 8007 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 8006 800a 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 0007 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  #8006 ;matrix/flood-matching JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 8001 8007 0003 0007 0005 0001 0007 0004 0002  )
  ( EXPECT 8001 8004 800c 0001 0003 0007 0003 0006 0007 0002  )
  ( EXPECT 8003 8004 8007 0006 0005 0001 0001 0003 0002 0008  )
  ( EXPECT 8006 800a 0009 0004 0009 0003 0001 0005 0006 0009  )
  ( EXPECT 800d 0004 0006 0003 0004 0001 0007 0001 0001 0001  )
  ( EXPECT 0001 0003 0001 0009 0001 0002 0008 0001 0003 0007  )
  ( EXPECT 0001 0003 0005 0009 0009 0001 0002 0004 0002 0001  )
  ( EXPECT 0003 0001 0002 0005 0004 0002 0001 0006 0003 0009  )
  ( EXPECT 0001 0002 0009 0003 0001 0003 0008 0005 0002 0001  )
  ( EXPECT 0002 0003 0001 0001 0009 0004 0004 0005 0008 0001  )
  STKCHK
  ;matrix/flood-all JSR2
  ;matrix/dump JSR2
  ( EXPECT 10 10 )
  ( EXPECT 8000 8001 8007 800a 8011 8016 8017 801e 8022 8024  )
  ( EXPECT 8001 8004 800c 800b 800e 8015 8017 801d 8020 8022  )
  ( EXPECT 8003 8004 8007 800d 8012 8013 8014 8017 8019 8021  )
  ( EXPECT 8006 800a 8010 8011 801a 8016 8015 801a 801f 8026  )
  ( EXPECT 800d 800e 8014 8014 8018 8017 801c 801b 801c 801d  )
  ( EXPECT 800e 8011 8012 801b 8019 8019 8021 801c 801f 8024  )
  ( EXPECT 800f 8012 8017 8020 8022 801a 801c 8020 8021 8022  )
  ( EXPECT 8012 8013 8015 801a 801e 801c 801d 8023 8024 802b  )
  ( EXPECT 8013 8015 801e 801d 801e 801f 8025 8028 8026 8027  )
  ( EXPECT 8015 8018 8019 801a 8023 8023 8027 802c 802e 8028  )
  STKCHK
  ;matrix/get-end-risk JSR2 DBGSHORTDEC POP2
  ( EXPECT 40 )


  T< "👍 >T
  BRK !

~day15_lib.tal

|f000
~library/test.tal

( s* -- get-byte )
@make-get-byte
  ;input STA2
  ;get-byte-from-input
  RTN

( -- b )
@get-byte-from-input
  [ ;input LDA2 ] LDA STH
  [ ;input LDA2 ] INC2 [ ;input STA2 ]
  STHr
  RTN

@input $2
